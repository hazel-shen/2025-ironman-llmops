# Day13 â€” Data Drift åµæ¸¬ Demo

æœ¬è³‡æ–™å¤¾å±•ç¤ºä¸‰ç¨® **çŸ¥è­˜åº«è®Šå‹•åµæ¸¬æ–¹æ³•**ï¼Œå°æ‡‰ 2025 éµäººè³½ Day13ï¼š

1. **Metadata åµæ¸¬**ï¼ˆæª”æ¡ˆå¤§å°ã€ä¿®æ”¹æ™‚é–“ã€hashï¼‰
2. **ç‰ˆæœ¬è™Ÿåµæ¸¬**ï¼ˆæ–‡ä»¶å…§å»ºç‰ˆæœ¬è™Ÿ / ç™¼å¸ƒæ—¥æœŸï¼‰
3. **Embedding èªæ„å·®ç•°æ¯”å°**ï¼ˆæ–‡å­—èªæ„æ˜¯å¦æœ‰é‡è¦è®Šå‹•ï¼‰

---

## ğŸ“¦ ç’°å¢ƒå®‰è£

ä½¿ç”¨ Conda å»ºç«‹ç’°å¢ƒï¼š

```bash
conda env create -f environment.yaml
conda activate day13_data_drift
```

è‹¥éœ€è¦è·‘ **èªæ„å·®ç•°åµæ¸¬**ï¼Œè«‹è¨­å®š OpenAI API Keyï¼š

```bash
export OPENAI_API_KEY=sk-xxxx
```

---

## ğŸ“‚ å°ˆæ¡ˆçµæ§‹

```bash
day13_data_drift/
â”œâ”€â”€ README.md                  # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ environment.yaml           # Conda ç’°å¢ƒè¨­å®š
â”‚
â”œâ”€â”€ metadata_comparison.py     # æª”æ¡ˆ metadata åµæ¸¬
â”œâ”€â”€ version_check.py           # ç‰ˆæœ¬è™Ÿåµæ¸¬
â”œâ”€â”€ embedding_comparison.py    # èªæ„å·®ç•°åµæ¸¬
â”‚
â”œâ”€â”€ faq_v1.yaml                # æ¸¬è©¦ FAQ èˆŠç‰ˆ
â”œâ”€â”€ faq_v2.yaml                # æ¸¬è©¦ FAQ æ–°ç‰ˆ
â”‚
â”œâ”€â”€ worker_manual.pdf          # æ¸¬è©¦ PDF
â””â”€â”€ worker_manual.meta.json    # PDF çš„ metadata ç´€éŒ„
```

---

## â–¶ï¸ ä½¿ç”¨æ–¹å¼

### 1. Metadata åµæ¸¬

æ¯”è¼ƒæª”æ¡ˆå¤§å°ã€ä¿®æ”¹æ™‚é–“èˆ‡ hashï¼š

```bash
python metadata_comparison.py
```

**ç¯„ä¾‹è¼¸å‡ºï¼š**

```bash
# æŠŠ Day12 çš„ worker_manual.pdf ç§»éä¾† Day13 ç”¨
â¯ python metadata_comparison.py
ğŸ“¥ ç¬¬ä¸€æ¬¡å»ºç«‹ metadata ç´€éŒ„ã€‚

# æª”æ¡ˆæ²’æœ‰è®Šå‹•çš„æƒ…æ³ä¸‹å†åŸ·è¡Œä¸€æ¬¡
â¯ python metadata_comparison.py
ğŸ“‚ æª”æ¡ˆ: worker_manual.pdf
  - ä¹‹å‰ä¿®æ”¹æ™‚é–“: 2025-09-27 11:17:25
  - ä¹‹å‰ Hash: 5106549b250c4c06a9bd1e59ab950e8a
  - ç›®å‰ä¿®æ”¹æ™‚é–“: 2025-09-27 11:17:25
  - ç›®å‰ Hash: 5106549b250c4c06a9bd1e59ab950e8a
âœ… æª”æ¡ˆå…§å®¹ç„¡è®Šæ›´ã€‚

# ä¿®æ”¹ worker_manual.pdf å¾Œå„²å­˜ï¼Œå†åŸ·è¡Œä¸€æ¬¡
â¯ python metadata_comparison.py
ğŸ“‚ æª”æ¡ˆ: worker_manual.pdf
  - ä¹‹å‰ä¿®æ”¹æ™‚é–“: 2025-09-27 11:17:25
  - ä¹‹å‰ Hash: 5106549b250c4c06a9bd1e59ab950e8a
  - ç›®å‰ä¿®æ”¹æ™‚é–“: 2025-09-27 11:25:57
  - ç›®å‰ Hash: 0323bd12d945343f73035ab4503b2e3d
âš ï¸ æª”æ¡ˆå…§å®¹å·²è®Šæ›´ï¼Œéœ€è¦æ›´æ–°çŸ¥è­˜åº«ï¼
```

### 2. ç‰ˆæœ¬è™Ÿåµæ¸¬

æ¯”å° YAML ä¸­çš„ version æ¬„ä½ï¼š

```bash
python version_check.py
```

**ç¯„ä¾‹è¼¸å…¥ï¼š**

```yaml
# faq_v1.yaml
version: 1.0.0
faq:
  - q: é€€è²¨æ”¿ç­–
    a: å•†å“éœ€åœ¨ 7 å¤©å…§é€€å›
```

```yaml
# faq_v2.yaml
version: 1.1.0
faq:
  - q: é€€è²¨æ”¿ç­–
    a: å•†å“éœ€åœ¨ 14 å¤©å…§é€€å›
  - q: æ˜¯å¦æ”¯æ´ç·šä¸Šå®¢æœï¼Ÿ
    a: æ˜¯çš„ï¼Œè«‹è‡³å®˜ç¶²é»é¸èŠå¤©å®¤
```

**ç¯„ä¾‹è¼¸å‡ºï¼š**

```bash
ğŸ“‹ ç‰ˆæœ¬æ¯”å°çµæœ
èˆŠç‰ˆæœ¬: 1.0.0
æ–°ç‰ˆæœ¬: 1.1.0
ğŸ”„ åµæ¸¬åˆ°ç‰ˆæœ¬æ›´æ–°ï¼Œå»ºè­°æ›´æ–°çŸ¥è­˜åº«
```

### 3. èªæ„å·®ç•°åµæ¸¬

ä½¿ç”¨ OpenAI Embedding åˆ¤æ–· FAQ å…§å®¹æ˜¯å¦æœ‰èªæ„ä¸Šçš„é‡å¤§å·®ç•°ï¼š

```bash
python embedding_comparison.py
```

**ç¯„ä¾‹è¼¸å‡ºï¼š**

```makefile
ğŸ§  èªæ„ç›¸ä¼¼åº¦åˆ†æ
èªæ„ç›¸ä¼¼åº¦: 0.9096
âš ï¸ åµæ¸¬åˆ°é‡è¦å·®ç•°ï¼Œéœ€è¦æ›´æ–°çŸ¥è­˜åº«ï¼

è©³ç´°æ¯”å°çµæœ:
- æ–°å¢å•é¡Œ: "æ˜¯å¦æ”¯æ´ç·šä¸Šå®¢æœï¼Ÿ"
- ä¿®æ”¹å…§å®¹: é€€è²¨æ”¿ç­–å¾ 7 å¤©æ”¹ç‚º 14 å¤©
```

---

## ğŸ“ æ³¨æ„äº‹é …

- `embedding_comparison.py` éœ€è¨­å®š `OPENAI_API_KEY` æ‰èƒ½é‹è¡Œ
- **ä¸é©åˆç”¨èªæ„æ¯”å°çš„å ´æ™¯**ï¼šç¨‹å¼ç¢¼ã€æ•¸æ“šè¡¨æ ¼ï¼Œè«‹æ”¹ç”¨å‚³çµ± diff
- **å»ºè­°ç”¨é€”**ï¼šæ³•å¾‹æ¢æ–‡ã€FAQã€SOPã€æ”¿ç­–æ–‡ä»¶ç­‰èªæ„æ•æ„Ÿçš„æ–‡æœ¬

---

## ğŸ”§ é€²éšé…ç½®

### èª¿æ•´èªæ„å·®ç•°é–¾å€¼

åœ¨ `embedding_comparison.py` ä¸­ä¿®æ”¹ï¼š

```python
SIMILARITY_THRESHOLD = 0.95  # é è¨­å€¼ï¼Œå¯èª¿æ•´
```

### è‡ªå®šç¾© Metadata æª¢æŸ¥é …ç›®

åœ¨ `metadata_comparison.py` ä¸­å¯æ–°å¢ï¼š

```python
def check_additional_metadata(filepath):
    # æ–°å¢æª”æ¡ˆæ¬Šé™ã€æ“æœ‰è€…ç­‰æª¢æŸ¥
    pass
```

## ğŸ“Š æ•ˆèƒ½åƒè€ƒ

| æª”æ¡ˆå¤§å° | Metadata åµæ¸¬ | èªæ„æ¯”å° |
| -------- | ------------- | -------- |
| < 1KB    | < 0.1s        | ~2s      |
| 1-10KB   | < 0.1s        | ~5s      |
| 10-100KB | < 0.5s        | ~15s     |

_èªæ„æ¯”å°æ™‚é–“ä¾ OpenAI API å›æ‡‰é€Ÿåº¦è€Œå®š_
